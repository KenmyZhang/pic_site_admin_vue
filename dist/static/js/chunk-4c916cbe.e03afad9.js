(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c916cbe"],{1678:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{title:"图片素材库","append-to-body":"",visible:t.listDialogVisible,width:"100%"},on:{"update:visible":function(e){t.listDialogVisible=e}}},[a("el-container",[a("el-aside",{attrs:{width:"unset"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{staticClass:"el-icon-plus",attrs:{size:"small"},on:{click:function(e){return t.materialgroupAdd()}}},[t._v("\n            添加分组\n          ")])],1),t._v(" "),a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:t.materialgroupLoading,expression:"materialgroupLoading"}],attrs:{"tab-position":"left"},on:{"tab-click":t.tabClick},model:{value:t.materialgroupObjId,callback:function(e){t.materialgroupObjId=e},expression:"materialgroupObjId"}},t._l(t.materialgroupList,(function(e,i){return a("el-tab-pane",{key:e.id},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(e.name))])])})),1)],1),t._v(" "),a("el-main",[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[t._v(t._s(t.materialgroupObj.name))]),t._v(" "),"-1"!=t.materialgroupObj.id?a("span",[a("el-button",{staticClass:"el-icon-edit",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"text"},on:{click:function(e){return t.materialgroupEdit(t.materialgroupObj)}}},[t._v("重命名")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"10px",color:"red"},attrs:{size:"small",type:"text"},on:{click:function(e){return t.materialgroupDelete(t.materialgroupObj)}}},[t._v("删除")])],1):t._e()]),t._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("el-upload",{attrs:{action:t.uploadApi,headers:t.headers,"file-list":[],"on-progress":t.handleProgress,"before-upload":t.beforeUpload,"on-success":t.handleSuccess,data:{type:1},multiple:""}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("批量上传")])],1)],1)],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}]},[t.tableData.length<=0?a("el-alert",{attrs:{title:"暂无数据",type:"info",closable:!1,center:"","show-icon":""}}):t._e(),t._v(" "),a("el-row",{attrs:{gutter:5}},[a("el-checkbox-group",{attrs:{max:t.num-t.value.length},model:{value:t.urls,callback:function(e){t.urls=e},expression:"urls"}},t._l(t.tableData,(function(e,i){return a("el-col",{key:i,attrs:{span:4}},[a("el-card",{attrs:{"body-style":{padding:"5px"}}},[a("el-image",{staticStyle:{width:"100%",height:"100px"},attrs:{src:e.url,fit:"contain","preview-src-list":[e.url],"z-index":999}}),t._v(" "),a("div",[a("el-checkbox",{staticClass:"material-name",attrs:{label:e.url}},[t._v("\n                        选择\n                      ")]),t._v(" "),a("el-row",[a("el-col",{staticClass:"col-do",attrs:{span:24}},[a("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){return t.materialDel(e)}}},[t._v("删除")])],1)],1)],1)],1)],1)})),1)],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.page.currentPage,"page-sizes":[12,24],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"update:currentPage":function(e){return t.$set(t.page,"currentPage",e)},"update:current-page":function(e){return t.$set(t.page,"currentPage",e)},"size-change":t.sizeChange,"current-change":t.pageChange}})],1)])],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.sureUrls}},[t._v("确 定")])],1)],1)])},n=[],r=(a("ac67"),a("32ea"),a("1bc7"),a("fc02"),a("a450"),a("3d88")),o=(a("e680"),a("854a")),l=a("2cf5"),s=a("5f87"),u=a("52c1");a("8dee");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}(function(){if(window.frameElement.id){var t=window.parent,e=t.$EDITORUI[window.frameElement.id.replace(/_iframe$/,"")],a=e.editor,i=t.UE,n=i.dom.domUtils,r=i.utils,o=(i.browser,i.ajax,function(t){return document.getElementById(t)});window.nowEditor={editor:a,dialog:e},r.loadFile(document,{href:a.options.themePath+a.options.theme+"/dialogbase.css?cache="+Math.random(),tag:"link",type:"text/css",rel:"stylesheet"});var l=a.getLang(e.className.split("-")[2]);l&&n.on(window,"load",(function(){var t=a.options.langPath+a.options.lang+"/images/";for(var e in l["static"]){var i=o(e);if(i){var s=i.tagName,u=l["static"][e];switch(u.src&&(u=r.extend({},u,!1),u.src=t+u.src),u.style&&(u=r.extend({},u,!1),u.style=u.style.replace(/url\s*\(/g,"url("+t)),s.toLowerCase()){case"var":i.parentNode.replaceChild(document.createTextNode(u),i);break;case"select":for(var c,p=i.options,d=0;c=p[d];)c.innerHTML=u.options[d++];for(var g in u)"options"!=g&&i.setAttribute(g,u[g]);break;default:n.setAttributes(i,u)}}}}))}})();var d={name:"MaterialList",props:{value:{type:Array,default:function(){return[]}},type:{type:String},num:{type:Number,default:function(){return 5}},width:{type:Number,default:function(){return 150}},height:{type:Number,default:function(){return 150}}},data:function(){return{headers:{Authorization:"Bearer "+Object(s["a"])()},dialogVisible:!0,url:"",listDialogVisible:!0,materialgroupList:[],materialgroupObjId:"",materialgroupObj:{},materialgroupLoading:!1,tableData:[],resultNumber:0,page:{total:0,currentPage:1,pageSize:12,ascs:[],descs:"create_time"},tableLoading:!1,groupId:null,urls:[]}},computed:p({},Object(u["b"])(["uploadApi"])),mounted:function(){this.toSeleteMaterial()},methods:{moveMaterial:function(t,e){if("up"==e){var a=this.value[t-1];this.$set(this.value,t-1,this.value[t]),this.$set(this.value,t,a)}if("down"==e){var i=this.value[t+1];this.$set(this.value,t+1,this.value[t]),this.$set(this.value,t,i)}},zoomMaterial:function(t){this.dialogVisible=!0,this.url=this.value[t]},deleteMaterial:function(t){var e=this;this.$confirm("是否确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.value.splice(t,1),e.urls=[]}))},toSeleteMaterial:function(){this.listDialogVisible=!0,this.tableData.length<=0&&this.materialgroupPage()},materialgroupPage:function(){var t=this;this.materialgroupLoading=!0,Object(o["c"])({total:0,page:1,size:100,ascs:[],sort:"create_time,desc"}).then((function(e){t.materialgroupLoading=!1;var a=e.data;a.unshift({id:"-1",name:"全部分组"}),t.materialgroupList=a,t.tabClick({index:0})}))},materialgroupDelete:function(t){var e=this;this.$confirm("是否确认删除该分组？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["b"])(t.id).then((function(){e.$delete(e.materialgroupList,t.index)}))}))},materialgroupEdit:function(t){var e=this;this.$prompt("请输入分组名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name}).then((function(a){var i=a.value;Object(o["d"])({id:t.id,name:i}).then((function(){t.name=i,e.$set(e.materialgroupList,t.index,t)}))})).catch((function(){}))},materialgroupAdd:function(){var t=this;this.$prompt("请输入分组名","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var a=e.value;Object(o["a"])({name:a}).then((function(){t.materialgroupPage()}))})).catch((function(){}))},tabClick:function(t,e){this.urls=[];var a=Number(t.index),i=this.materialgroupList[a];i.index=a,this.materialgroupObj=i,this.materialgroupObjId=i.id,this.page.currentPage=1,this.page.total=0,"-1"!=i.id?this.groupId=i.id:this.groupId=null,this.getPage(this.page)},getPage:function(t,e){var a=this;this.tableLoading=!0,Object(l["c"])(Object.assign({page:t.currentPage-1,size:t.pageSize,descs:this.page.descs,ascs:this.page.ascs,sort:"create_time,desc"},{groupId:this.groupId})).then((function(e){var i=e.data.content||[];a.page.total=e.data.totalElements,a.page.currentPage=t.currentPage,a.page.pageSize=t.pageSize,a.tableData=i,a.tableLoading=!1})).catch((function(){a.tableLoading=!1}))},sizeChange:function(t){this.page.currentPage=1,this.page.pageSize=t,this.getPage(this.page)},pageChange:function(t){this.page.currentPage=t,this.getPage(this.page)},materialRename:function(t){var e=this;this.$prompt("请输入素材名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name}).then((function(a){var i=a.value;Object(l["d"])({id:t.id,name:i}).then((function(){e.getPage(e.page)}))})).catch((function(){}))},materialUrl:function(t){this.$prompt("素材链接","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.url}).then((function(t){t.value})).catch((function(){}))},materialDel:function(t){var e=this;this.$confirm("是否确认删除该素材？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["b"])(t.id).then((function(){e.getPage(e.page)}))}))},handleCommand:function(t){var e=this,a=t.split("-");Object(l["d"])({id:a[0],groupId:a[1]}).then((function(){e.getPage(e.page)}))},handleProgress:function(t,e,a){},handleSuccess:function(t,e,a){var i=this,n=this;this.uploadProgress=0,Object(l["a"])({type:"1",groupId:"-1"!=this.groupId?this.groupId:null,name:e.name,url:t.data}).then((function(){i.resultNumber++,a.length===i.resultNumber&&(n.getPage(n.page),i.resultNumber=0)}))},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type||"image/jpg"===t.type,a=t.size/1024/1024<2;return e?(a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a):(this.$message.error("上传图片只能是 JPG、JPEG、PNG、GIF 格式!"),!1)},sureUrls:function(){var t="";this.urls.forEach((function(e){t+='<img src="'+e+'">'})),nowEditor.dialog.close(!0),nowEditor.editor.setContent(t,!0),this.listDialogVisible=!1}}},g=d,m=(a("dc45"),a("e607")),h=Object(m["a"])(g,i,n,!1,null,"1023243c",null);e["default"]=h.exports},"2cf5":function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"d",(function(){return l}));var i=a("b775");function n(t){return Object(i["a"])({url:"admin/material",method:"get",params:t})}function r(t){return Object(i["a"])({url:"admin/material",method:"post",data:t})}function o(t){return Object(i["a"])({url:"admin/material/"+t,method:"delete"})}function l(t){return Object(i["a"])({url:"admin/material",method:"put",data:t})}},"7fa7":function(t,e,a){},"854a":function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"d",(function(){return l}));var i=a("b775");function n(t){return Object(i["a"])({url:"admin/materialgroup",method:"get",params:t})}function r(t){return Object(i["a"])({url:"admin/materialgroup",method:"post",data:t})}function o(t){return Object(i["a"])({url:"admin/materialgroup/"+t,method:"delete"})}function l(t){return Object(i["a"])({url:"admin/materialgroup",method:"put",data:t})}},dc45:function(t,e,a){"use strict";a("7fa7")}}]);